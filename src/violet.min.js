var Violet={Util:{}};Violet.Util.uri_encode=function(c){return encodeURIComponent(c).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")};Violet.Util.mergeHash=function(){var c=arguments.length,a,e,b={};for(a=0;a<c;a++){var d=arguments[a];for(e in d)d.hasOwnProperty(e)&&(b[e]=d[e])}return b};
Violet.HTTPClient=function Class(a){if(!(this instanceof Class))return new Class(a);a||(a={});this.method=a.method||"GET";this.uri=a.uri||"";this.post_data={};this.authorization_header=null;this.onloading=function(){};this.onsuccess=function(){};this.onerror=function(){};this.request=new XMLHttpRequest({mozSystem:!0})};
(function(){var c=Violet.HTTPClient.prototype;c.start=function(){var a=this.request;a.open(this.method,this.uri,!0);null!==this.authorization_header&&a.setRequestHeader("Authorization",this.authorization_header);"POST"===this.method&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.onreadystatechange=function(){if(3===a.readyState)this.onloading(a);else if(4===a.readyState)if(200===a.status)this.onsuccess(a);else this.onerror(a)}.bind(this);a.send(this.postBody())};c.stop=
function(){this.request.abort()};c.setOAuthHeader=function(a){var e="",b=[];for(e in a)a.hasOwnProperty(e)&&(b[b.length]=e+'="'+a[e]+'"');this.authorization_header="OAuth "+b.join(", ")};c.postBody=function(){if("GET"===this.method||0===this.post_data.length)return null;var a="",e=this.post_data,b=[];for(a in e)e.hasOwnProperty(a)&&b.push(a+"="+Violet.Util.uri_encode(e[a]));return b.join("&")}})();
Violet.OAuth=function Class(a){if(!(this instanceof Class))return new Class(a);a||(a={});this.base_uri=a.uri;this.consumer_key=a.consumer_key;this.consumer_secret=a.consumer_secret;this.access_token=a.access_token;this.access_token_secret=a.access_token_secret;this.oauth_token_secret=this.oauth_token=""};
(function(){var c=Violet.OAuth.prototype;c.obtainAuthorizeURI=function(a,e){var b=Violet.HTTPClient({uri:"https://api.twitter.com/oauth/request_token",method:"POST"}),d={oauth_callback:"oob",oauth_consumer_key:this.consumer_key,oauth_nonce:this.generateNonce(32),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:String(Math.floor(new Date/1E3)),oauth_version:"1.0"};d.oauth_signature=this.generateSignature("POST","https://api.twitter.com/oauth/request_token",d,"");b.setOAuthHeader(d);b.onsuccess=function(b){b=
b.responseText.split("&");var d,e=b.length,c={};for(d=0;d<e;d++){var h=b[d].split("=");c[h[0]]=h[1]}this.oauth_token=c.oauth_token;this.oauth_token_secret=c.oauth_token_secret;a("https://api.twitter.com/oauth/authorize?oauth_token="+c.oauth_token)}.bind(this);b.onerror=e;b.start()};c.obtainAccessToken=function(a,c,b){var d=Violet.HTTPClient({uri:"https://api.twitter.com/oauth/access_token",method:"POST"});a={oauth_consumer_key:this.consumer_key,oauth_nonce:this.generateNonce(32),oauth_signature_method:"HMAC-SHA1",
oauth_timestamp:String(Math.floor(new Date/1E3)),oauth_token:this.oauth_token,oauth_verifier:a,oauth_version:"1.0"};a.oauth_signature=this.generateSignature("POST","https://api.twitter.com/oauth/access_token",a,this.oauth_token_secret);d.setOAuthHeader(a);d.onsuccess=function(a){a=a.responseText.split("&");var b,d=a.length,l={};for(b=0;b<d;b++){var h=a[b].split("=");l[h[0]]=h[1]}this.access_token=l.access_token;this.access_token_secret=l.access_token_secret;c(l)}.bind(this);d.onerror=b;d.start()};
c.obtainOAuthParams=function(a,c,b){var d={oauth_consumer_key:this.consumer_key,oauth_nonce:this.generateNonce(32),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:String(Math.floor(new Date/1E3)),oauth_token:this.access_token,oauth_version:"1.0"};d.oauth_signature=this.generateSignature(a,c,Violet.Util.mergeHash(d,b),this.access_token_secret);return d};c.generateNonce=function(a){var c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),b,d="";for(b=0;b<a;b++)d+=c[Math.floor(61*
Math.random())];return d};c.generateSignature=function(a,c,b,d){var f=[],g,k;a=a.toUpperCase()+"&"+Violet.Util.uri_encode(c)+"&";for(g in b)b.hasOwnProperty(g)&&(f[f.length]=g);f.sort();c=f.length;k=[];for(g=0;g<c;g++)k[k.length]=f[g]+"="+Violet.Util.uri_encode(b[f[g]]);a+=Violet.Util.uri_encode(k.join("&"));d||(d="");b=new jsSHA(a,"TEXT");return Violet.Util.uri_encode(b.getHMAC(this.consumer_secret+"&"+d,"TEXT","SHA-1","B64"))}})();Violet.Endpoints={};Violet.Endpoints.get="statuses/mentions_timeline;statuses/user_timeline;statuses/home_timeline;statuses/retweets_of_me;statuses/retweets/:id;statuses/show/:id;statuses/oembed;statuses/retweeters/ids;search/tweets;statuses/sample;statuses/firehose;user;site;direct_messages;direct_messages/sent;direct_messages/show;friendships/no_retweets/ids;friends/ids;followers/ids;friendships/lookup;friendships/incoming;friendships/outgoing;friendships/show;friends/list;followers/list;account/settings;account/verify_credentials;blocks/list;blocks/ids;users/lookup;users/show;users/search;users/contributees;users/contributors;users/profile_banner;users/suggestions/:slug;users/suggestions;users/suggestions/:slug/members;favorites/list;lists/list;lists/statuses;lists/memberships  ;lists/subscribers;lists/subscribers/show;lists/members/show;lists/members;lists/show;lists/subscriptions;lists/ownerships;saved_searches/list;saved_searches/show/:id;geo/id/:place_id;geo/reverse_geocode;geo/searc;geo/similar_places;trends/place;trends/available;trends/closest;oauth/authenticate;oauth/authorize  ;help/configuration;help/languages;help/privacy;help/tos;application/rate_limit_status".split(";");
Violet.Endpoints.post="statuses/destroy/:id statuses/update statuses/retweet/:id statuses/update_with_media statuses/filter direct_messages/destroy direct_messages/new friendships/create friendships/destroy friendships/update account/settings account/update_delivery_device account/update_profile_background_image account/update_profile_colors account/update_profile_image blocks/create blocks/destroy account/remove_profile_banner account/update_profile_banner favorites/destroy favorites/create lists/members/destroy lists/subscribers/create lists/subscribers/destroy lists/members/create_all lists/members/create lists/destroy lists/update lists/create lists/members/destroy_all saved_searches/create saved_searches/destroy/:id geo/place users/report_spam oauth/access_token oauth/request_token oauth2/token oauth2/invalidate_token".split(" ");
Violet.Endpoints.method=function(c){var a=null;-1!==Violet.Endpoints.get.indexOf(c)?a="GET":-1!==Violet.Endpoints.post.indexOf(c)&&(a="POST");return a};Violet.Request=function(c,a,e,b){var d=Violet.Endpoints.method(c);c=this.base_uri+c+".json";var f=Violet.HTTPClient({method:d,uri:c});f.setOAuthHeader(this.oauth.obtainOAuthParams(d,c,a));f.onsuccess=e;f.onerror=b;f.post_data=a;f.start()};Violet.Streaming=function Class(a){if(!(this instanceof Class))return new Class(a);this.oauth=a};
(function(){var c=Violet.Streaming.prototype;c.start=function(a,c){var b=Violet.HTTPClient({method:"GET",uri:"https://userstream.twitter.com/1.1/user.json"});b.setOAuthHeader(this.oauth.obtainOAuthParams("GET","https://userstream.twitter.com/1.1/user.json"));b.onloading=function(b){b=b.responseText.split("\r\n");if(!b[b.length-2])return!1;a(JSON.parse(b[b.length-2]))};b.onerror=c;b.start();this.connection=b};c.stop=function(){this.connection.stop();this.connection=null}})();
Violet.init=function Class(a){if(!(this instanceof Class))return new Class(a);this.base_uri="https://api.twitter.com/1.1/";this.consumer_key=a.consumer_key;this.consumer_secret=a.consumer_secret;this.access_token=a.access_token||"";this.access_token_secret=a.access_token_secret||"";this.initialize()};
(function(){Violet.init.prototype.initialize=function(){this.oauth=Violet.OAuth({consumer_key:consumer_key,consumer_secret:consumer_secret,access_token:access_token,access_token_secret:access_token_secret});this.streaming=Violet.Streaming(this.oauth);this.request=Violet.Request.bind(this)}})();
